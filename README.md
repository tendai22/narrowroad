# narrowroad -- 「octalのほそ道」をたどる

68008搭載のワンボードマイコン上に FORTH をくみ上げて行くプロジェクトです。

ソフトそのものよりも、小さなパーツを少しずつ段階的にくみ上げてゆく。FORTH発明者であるCharls Mooreの旅路を追体験することで、FORTH処理系の上での暮らしを感じ取ることと、感じたことを共有することを目的としています。

Mooreは自分一人で使うことを想定して、機械語サブルーチン群と、それを組み合わせて使うためのインタプリタを作り、磨きを掛けていました。1970年前後のことです。これがFORTHの始まりです。フリープログラム書きとして、顧客要望に応じてさまざまなマシンのための仕事を受ける際に、そのサブルーチン群とインタプリタを、新しいマシンに実現するところから始めました。そのコア部分は機械語で記述するので、その新しいマシンのアセンブラを自前で作るところから行ったと言います。

当時からそれぞれのマシンに対してFORTRANなどの高級言語コンパイラとライブラリは提供されていたでしょうが、マシンによってその完成度はさまざまだったのでしょう。バグがあるかもしれないツール・性能面で遅すぎるライブラリ・限られたメモリ領域を食いつぶすライブラリがブラックボックス状態で不満があっても手も足も出ない状況に直面するうちに、彼は、「すべて自前でやる・自分の手が入ったものしか使わない」の立場に立ち、「サブルーチン群とインタプリタ」を構築・維持してきたのです。

表示出力とキーボード入力を扱うシリアル入出力サブルーチンに始まり、FORTHの機能を構成するサブルーチン群のどれをどの順番で作ってゆくかについては、彼の著作[Programming A Problem-Oriented Language](http://www.forth.org/POL.pdf)に書かれています。1970年に書かれたこの文書は、数多くのミニコンにFORTH開発環境を移植した経験を踏まえています。このタイトルから分かるように、移植手順書ではなく、FORTHでアプリケーションプログラムを書くとはどういうことか、までカバーする良い文書だと思います。

ここでは、この文書の9章に記載された順序に従い、68008搭載のワンボードマイコン上にFORTH処理系を機械語で構成してゆきます。個々の機能を実現するおりおりでその機能のFORTHにおける位置づけをコメントしてゆけば、読んでいて少しは興味が湧くかもしれません。この順序で行ったことを記した Markdown ファイル(とPDFファイル)を残してゆきます。また、進行途中のFORTH機械語プログラムを本リポジトリで管理してゆきます。`git log`コマンドを見ながら途中のスナップショットをチェックアウトすることで、その時の状態のプログラムを実機にロードして動かしてみることができます。

Mooreにならったわけではありませんが、私も 68008用のアセンブラを用意しました。と言ってもGNU binutilsをビルドしてそのアセンブラ、リンカ、objdumpを使っているだけですが。

* 第1章: [FORTHの世界](doc/ch01.md)

